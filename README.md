# PharmaChat Streamlit App

This repository contains the code for a Streamlit application, `app.py`, that interacts with the PharmaChat API.  It also includes the necessary configuration files for managing dependencies and containerizing the application using Docker.

## Files

* **`app.py`**: The Streamlit application code.  It provides a user interface to query the PharmaChat API with a medicament name and a question.
* **`Dockerfile`**:  A Dockerfile used to build a Docker image for the application, ensuring consistent deployment.
* **`.gitignore`**: Specifies intentionally untracked files that Git should ignore. This usually includes temporary files, build artifacts, and sensitive information.
* **`poetry.lock`**:  A file generated by Poetry that ensures deterministic installations across different environments. It locks the exact versions of dependencies used.
* **`pyproject.toml`**:  A file that contains the project's dependencies and build configuration, used by Poetry.

## `app.py` Description

The `app.py` file creates a Streamlit web application with the following functionality:

* **Title:** "PharmaChat: Your Pharma Assistant"
* **Input Fields:**
    * A text input field for the user to enter the name of a medicament.
    * A text input field for the user to enter their question about the medicament.
* **Submit Button:** A button that, when clicked, sends a POST request to the PharmaChat API with the provided medicament and question.
* **API Interaction:**
    * It sends a POST request to `http://pharmachat:8000/query` with a JSON payload containing the `medicament` and `question`.
    * It handles the API response, displaying the result or an error message in the Streamlit app.
* **Error Handling:** It includes error handling for:
    * Missing input fields.
    * Successful API responses (status code 200).
    * API errors (e.g., 404 Not Found).
    * Connection errors when trying to reach the API.

## `Dockerfile` Description

The `Dockerfile` sets up the environment to run the Streamlit application. Here's a breakdown:

* **`FROM python:3.12-slim`**:  Uses a minimal Debian-based Python 3.12 image as the base.
* **`WORKDIR /app`**:  Sets the working directory inside the container to `/app`.
* **`RUN apt-get update && apt-get install -y ...`**:  Installs system-level dependencies like `curl` and `build-essential`, which are required for Poetry and some Python packages.  It also cleans up the apt lists to reduce image size.
* **`RUN curl -sSL https://install.python-poetry.org | python3 -`**:  Installs Poetry, a Python dependency management tool.
* **`ENV PATH="/root/.local/bin:$PATH"`**:  Adds Poetry's executable directory to the system's PATH, making the `poetry` command available.
* **`COPY pyproject.toml poetry.lock ./`**:  Copies the Poetry configuration files to the `/app` directory.
* **`RUN poetry config virtualenvs.create false ...`**: Configures Poetry to not create a virtual environment (for simplicity within the container) and then installs the project dependencies using `poetry install`. The flags `--no-root`, `--no-interaction`, and `--no-ansi` are used to optimize the installation process for a Docker environment.
* **`COPY app.py .`**:  Copies the `app.py` file to the `/app` directory.
* **`EXPOSE 8501`**:  Exposes port 8501, which is the default port Streamlit uses.
* **`CMD ["poetry", "run", "streamlit", "run", "app.py", "--server.port=8501", "--server.address=0.0.0.0"]`**:  Defines the command to run when the container starts. It uses Poetry to run the Streamlit application, specifying the port and allowing access from any IP address (0.0.0.0).

## Usage

### Prerequisites

* Docker installed on your system.
* (Optional) Poetry installed on your system if you want to run the app locally outside of Docker.

### Running with Docker

1.  **Build the Docker image:**

    ```bash
    docker build -t pharmachat-app .
    ```

2.  **Run the Docker container:**

    ```bash
    docker run -p 8501:8501 pharmachat-app
    ```

3.  **Access the application:**

    Open your web browser and go to `http://localhost:8501`.

### Running Locally (Optional)

1.  **Install dependencies:**

    ```bash
    poetry install
    ```

2.  **Run the Streamlit app:**

    ```bash
    poetry run streamlit run app.py --server.port=8501 --server.address=0.0.0.0
    ```

## License

This project is licensed under the MIT License. See the `LICENSE` file for details.

## Authors

Ramon Botella Nieto rbnieto@gmail.com
